import { useState, useEffect, useCallback, useRef } from "react";
import { createClient } from "@supabase/supabase-js";

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   UDYAM PATH ‚Äî ‡§â‡§¶‡•ç‡§Ø‡§Æ ‡§™‡§•
   REAL-TIME Career Platform
   Connected to: Supabase + Adzuna API + Resend Email
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

// ‚îÄ‚îÄ Supabase Client (replace with your keys) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SUPABASE_URL  = import.meta.env.VITE_SUPABASE_URL  || "https://YOUR_PROJECT.supabase.co";
const SUPABASE_ANON = import.meta.env.VITE_SUPABASE_ANON || "YOUR_ANON_KEY";
const supabase = createClient(SUPABASE_URL, SUPABASE_ANON);

/* ‚îÄ‚îÄ Styles ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const Styles = () => (
  <style>{`
    @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Nunito:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600&display=swap');
    *{box-sizing:border-box;margin:0;padding:0;}
    html{scroll-behavior:smooth;}
    body{font-family:'Nunito',sans-serif;background:#09090F;color:#F0F0FF;overflow-x:hidden;}
    ::-webkit-scrollbar{width:4px;}
    ::-webkit-scrollbar-thumb{background:#AAFF00;border-radius:99px;}
    @keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
    @keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    @keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-50%)}}
    @keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
    @keyframes glow{0%,100%{box-shadow:0 0 20px #AAFF0040}50%{box-shadow:0 0 50px #AAFF0080}}
    @keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
    @keyframes popIn{0%{transform:scale(0.5);opacity:0}80%{transform:scale(1.05)}100%{transform:scale(1);opacity:1}}
    .fu{animation:fadeUp .5s cubic-bezier(.22,1,.36,1) both}
    .fu1{animation:fadeUp .5s cubic-bezier(.22,1,.36,1) .1s both}
    .fu2{animation:fadeUp .5s cubic-bezier(.22,1,.36,1) .2s both}
    .fu3{animation:fadeUp .5s cubic-bezier(.22,1,.36,1) .3s both}
    .float{animation:float 4s ease-in-out infinite}
    .spin{animation:spin .8s linear infinite}
    .btn{transition:all .18s cubic-bezier(.22,1,.36,1);cursor:pointer;}
    .btn:active{transform:scale(.96);}
    .card-hover{transition:all .25s cubic-bezier(.22,1,.36,1);}
    .card-hover:hover{transform:translateY(-4px);box-shadow:0 20px 60px rgba(170,255,0,.08)!important;}
    .input-z:focus{outline:none!important;border-color:#AAFF00!important;box-shadow:0 0 0 3px #AAFF0015!important;}
    .tag{display:inline-flex;align-items:center;padding:3px 10px;border-radius:99px;font-size:10px;font-weight:800;letter-spacing:.6px;text-transform:uppercase;}
    .shimmer-bg{background:linear-gradient(90deg,#1A1A2E 0%,#2A2A3E 50%,#1A1A2E 100%);background-size:200% 100%;animation:shimmer 1.5s infinite;}
    .grid-pattern{background-image:linear-gradient(rgba(170,255,0,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(170,255,0,.03) 1px,transparent 1px);background-size:40px 40px;}
    .marquee-wrap{overflow:hidden;width:100%;}
    .marquee-inner{display:flex;animation:marquee 35s linear infinite;width:max-content;}
    .pop{animation:popIn .4s cubic-bezier(.34,1.56,.64,1) both;}
    .glow-pulse{animation:glow 2s ease-in-out infinite;}
    .nav-active{color:#AAFF00!important;}
    :root{--lime:#AAFF00;--gold:#FFB800;--coral:#FF4D6D;--sky:#38BDF8;--violet:#A78BFA;--mint:#34D399;}
  `}</style>
);

const C = {
  lime:"#AAFF00", gold:"#FFB800", coral:"#FF4D6D", sky:"#38BDF8",
  violet:"#A78BFA", mint:"#34D399", bg:"#09090F", surface:"#13131F",
  card:"#1A1A2E", border:"rgba(255,255,255,.07)", muted:"rgba(255,255,255,.35)"
};

/* ‚îÄ‚îÄ Small Components ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const Chip = ({children, color=C.lime}) => (
  <span className="tag" style={{background:`${color}18`,color,border:`1px solid ${color}30`}}>{children}</span>
);

const Spinner = ({size=24,color=C.lime}) => (
  <div className="spin" style={{width:size,height:size,border:`2px solid ${color}20`,borderTop:`2px solid ${color}`,borderRadius:"50%"}}/>
);

const SkeletonCard = () => (
  <div style={{background:C.card,borderRadius:20,padding:20,border:`1px solid ${C.border}`}}>
    {[["100%",14],["70%",12],["50%",10],["85%",10]].map(([w,h],i)=>(
      <div key={i} className="shimmer-bg" style={{width:w,height:h,borderRadius:6,marginBottom:10}}/>
    ))}
  </div>
);

const Toast = ({msg,type="success",onClose}) => (
  <div className="pop" style={{position:"fixed",bottom:24,right:24,zIndex:999,padding:"14px 20px",borderRadius:16,
    background:type==="success"?`${C.mint}18`:type==="error"?`${C.coral}18`:`${C.gold}18`,
    border:`1px solid ${type==="success"?C.mint:type==="error"?C.coral:C.gold}40`,
    display:"flex",gap:12,alignItems:"center",maxWidth:360,boxShadow:"0 20px 60px rgba(0,0,0,.4)"}}>
    <span style={{fontSize:20}}>{type==="success"?"‚úÖ":type==="error"?"‚ùå":"‚ö†Ô∏è"}</span>
    <span style={{fontSize:13,fontWeight:700,color:"rgba(255,255,255,.8)",flex:1}}>{msg}</span>
    <span onClick={onClose} style={{fontSize:18,color:"rgba(255,255,255,.3)",cursor:"pointer"}}>‚úï</span>
  </div>
);

/* ‚îÄ‚îÄ Auth Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const AuthModal = ({onClose, onAuth}) => {
  const [mode,setMode] = useState("login"); // login | signup | otp
  const [email,setEmail] = useState("");
  const [password,setPassword] = useState("");
  const [name,setName] = useState("");
  const [loading,setLoading] = useState(false);
  const [error,setError] = useState("");
  const [otpSent,setOtpSent] = useState(false);

  const handleAuth = async () => {
    if (!email) return setError("Email is required");
    setLoading(true); setError("");
    try {
      if (mode === "otp") {
        // Passwordless magic link / OTP
        const { error } = await supabase.auth.signInWithOtp({ email, options: { emailRedirectTo: window.location.origin } });
        if (error) throw error;
        setOtpSent(true);
      } else if (mode === "login") {
        const { data, error } = await supabase.auth.signInWithPassword({ email, password });
        if (error) throw error;
        onAuth(data.user);
        onClose();
      } else {
        if (!name) return setError("Name is required");
        const { data, error } = await supabase.auth.signUp({ email, password,
          options: { data: { full_name: name }, emailRedirectTo: window.location.origin }
        });
        if (error) throw error;
        if (data.user) { onAuth(data.user); onClose(); }
        else setError("Check your email to confirm your account!");
      }
    } catch (err) {
      setError(err.message || "Something went wrong");
    } finally { setLoading(false); }
  };

  const handleGoogle = async () => {
    const { error } = await supabase.auth.signInWithOAuth({ provider:"google", options:{ redirectTo: window.location.origin } });
    if (error) setError(error.message);
  };

  return (
    <div style={{position:"fixed",inset:0,zIndex:400,display:"flex",alignItems:"center",justifyContent:"center",padding:20}}>
      <div onClick={onClose} style={{position:"absolute",inset:0,background:"rgba(0,0,0,.85)",backdropFilter:"blur(10px)"}}/>
      <div className="pop" style={{position:"relative",background:C.surface,borderRadius:28,padding:32,maxWidth:420,width:"100%",border:`1px solid ${C.border}`,boxShadow:"0 40px 100px rgba(0,0,0,.6)"}}>
        <div onClick={onClose} style={{position:"absolute",top:16,right:16,width:36,height:36,borderRadius:12,background:C.card,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:`1px solid ${C.border}`,color:C.muted,fontSize:18}}>‚úï</div>

        <div style={{textAlign:"center",marginBottom:28}}>
          <div style={{fontSize:40,marginBottom:12}}>üöÄ</div>
          <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:26,color:"#fff",letterSpacing:1}}>{mode==="login"?"WELCOME BACK":mode==="signup"?"JOIN UDYAM PATH":"MAGIC LINK"}</div>
          <div style={{fontSize:13,color:C.muted,marginTop:4}}>Free forever ¬∑ No credit card</div>
        </div>

        {otpSent ? (
          <div style={{textAlign:"center",padding:"20px 0"}}>
            <div style={{fontSize:48,marginBottom:12}}>üìß</div>
            <div style={{fontWeight:800,color:"#fff",fontSize:16,marginBottom:8}}>Check Your Email!</div>
            <div style={{fontSize:13,color:C.muted,lineHeight:1.8}}>We sent a magic link to <strong style={{color:C.lime}}>{email}</strong>. Click it to sign in instantly.</div>
          </div>
        ) : (
          <>
            {/* Google Auth */}
            <div onClick={handleGoogle} className="btn" style={{width:"100%",padding:"13px",borderRadius:14,background:C.card,border:`1px solid ${C.border}`,display:"flex",alignItems:"center",justifyContent:"center",gap:10,marginBottom:20,fontSize:14,fontWeight:700,color:"rgba(255,255,255,.7)"}}>
              <span style={{fontSize:20}}>üîµ</span> Continue with Google
            </div>
            <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:20}}>
              <div style={{flex:1,height:1,background:C.border}}/><span style={{fontSize:11,color:C.muted}}>OR</span><div style={{flex:1,height:1,background:C.border}}/>
            </div>

            {mode==="signup" && (
              <div style={{marginBottom:14}}>
                <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:6,textTransform:"uppercase",letterSpacing:.6}}>Full Name *</label>
                <input value={name} onChange={e=>setName(e.target.value)} placeholder="Arjun Kumar" className="input-z"
                  style={{width:"100%",padding:"13px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.card,color:"#fff"}}/>
              </div>
            )}

            <div style={{marginBottom:14}}>
              <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:6,textTransform:"uppercase",letterSpacing:.6}}>Email *</label>
              <input value={email} onChange={e=>setEmail(e.target.value)} placeholder="you@email.com" type="email" className="input-z"
                style={{width:"100%",padding:"13px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.card,color:"#fff"}}/>
            </div>

            {mode !== "otp" && (
              <div style={{marginBottom:14}}>
                <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:6,textTransform:"uppercase",letterSpacing:.6}}>Password *</label>
                <input value={password} onChange={e=>setPassword(e.target.value)} placeholder="Min 8 characters" type="password" className="input-z"
                  style={{width:"100%",padding:"13px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.card,color:"#fff"}}/>
              </div>
            )}

            {error && <div style={{fontSize:12,color:C.coral,marginBottom:12,padding:"10px 14px",borderRadius:10,background:`${C.coral}12`,fontWeight:700}}>‚ö†Ô∏è {error}</div>}

            <button onClick={handleAuth} disabled={loading} className="btn glow-pulse"
              style={{width:"100%",padding:16,borderRadius:14,background:loading?"rgba(170,255,0,.3)":`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,border:"none",fontFamily:"'Bebas Neue',cursive",fontSize:20,letterSpacing:1,cursor:loading?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10}}>
              {loading ? <><Spinner size={20} color={C.bg}/> Processing...</> : mode==="login"?"SIGN IN ‚Üí":mode==="signup"?"CREATE FREE ACCOUNT ‚Üí":"SEND MAGIC LINK ‚úâÔ∏è"}
            </button>

            <div style={{display:"flex",justifyContent:"center",gap:16,marginTop:16,fontSize:12,flexWrap:"wrap"}}>
              {mode!=="login"&&<span onClick={()=>{setMode("login");setError("");}} style={{color:C.lime,cursor:"pointer",fontWeight:700}}>Already have account? Sign In</span>}
              {mode!=="signup"&&<span onClick={()=>{setMode("signup");setError("");}} style={{color:C.muted,cursor:"pointer"}}>Create Account</span>}
              {mode!=="otp"&&<span onClick={()=>{setMode("otp");setError("");}} style={{color:C.muted,cursor:"pointer"}}>Magic Link (No Password)</span>}
            </div>
          </>
        )}
      </div>
    </div>
  );
};

/* ‚îÄ‚îÄ Job Card ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const JobCard = ({job, onOpen, saved, onSave, user, onAuthRequired}) => {
  const isFull = job.filled_seats >= job.total_seats;
  const pct = Math.min(100, Math.round(((job.filled_seats||0)/(job.total_seats||1))*100));
  const urgent = pct >= 80;

  const handleSave = (e) => {
    e.stopPropagation();
    if (!user) return onAuthRequired();
    onSave(job.id);
  };

  return (
    <div className="card-hover" onClick={()=>!isFull&&onOpen(job)}
      style={{background:C.card,borderRadius:20,padding:20,border:`1px solid ${isFull?"rgba(255,77,109,.15)":C.border}`,
        cursor:isFull?"default":"pointer",position:"relative",opacity:isFull?.6:1,transition:"all .25s"}}>

      {/* Status badges */}
      {isFull && <span className="tag" style={{position:"absolute",top:14,right:46,background:`${C.coral}20`,color:C.coral,border:`1px solid ${C.coral}30`}}>FILLED</span>}
      {job.is_hot && !isFull && <span className="tag" style={{position:"absolute",top:14,right:46,background:`${C.lime}20`,color:C.lime,border:`1px solid ${C.lime}30`}}>üî• HOT</span>}
      {job.is_new && !isFull && !job.is_hot && <span className="tag" style={{position:"absolute",top:14,right:46,background:`${C.sky}20`,color:C.sky,border:`1px solid ${C.sky}30`}}>NEW</span>}

      {/* Save */}
      <div onClick={handleSave} style={{position:"absolute",top:12,right:14,fontSize:18,cursor:"pointer",opacity:.6,transition:"opacity .2s"}}
        onMouseEnter={e=>e.target.style.opacity=1} onMouseLeave={e=>e.target.style.opacity=.6}>
        {saved?"üîñ":"üè∑Ô∏è"}
      </div>

      {/* Header */}
      <div style={{display:"flex",gap:12,marginBottom:14}}>
        <div style={{width:46,height:46,borderRadius:14,background:`linear-gradient(135deg,${job.logo_color_1||C.lime},${job.logo_color_2||C.mint})`,
          display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:900,fontSize:18,fontFamily:"'Bebas Neue',cursive",flexShrink:0}}>
          {(job.company_name||"?")[0].toUpperCase()}
        </div>
        <div style={{flex:1,minWidth:0}}>
          <div style={{fontWeight:800,fontSize:15,color:"#fff",marginBottom:3,lineHeight:1.2}}>{job.title}</div>
          <div style={{fontSize:12,color:C.muted}}>{job.company_name} ¬∑ {job.location}</div>
        </div>
      </div>

      {/* Chips */}
      <div style={{display:"flex",gap:6,flexWrap:"wrap",marginBottom:10}}>
        <Chip color={["Remote","WFH"].includes(job.work_type)?C.lime:job.work_type==="Hybrid"?C.violet:C.gold}>
          {job.work_type==="Remote"?"üåç Remote":job.work_type==="WFH"?"üè† WFH":job.work_type==="Hybrid"?"üîÑ Hybrid":"üè¢ "+job.work_type}
        </Chip>
        <Chip color={job.region==="India"?C.gold:C.sky}>{job.region==="India"?"üáÆüá≥ India":"üåê "+job.region}</Chip>
        <Chip color="rgba(255,255,255,.2)">{job.experience_level}</Chip>
      </div>

      {/* Tags */}
      <div style={{display:"flex",gap:5,flexWrap:"wrap",marginBottom:12}}>
        {(job.skills_tags||[]).slice(0,3).map(t=>(
          <span key={t} style={{fontSize:10,fontWeight:700,padding:"3px 8px",borderRadius:6,background:`${C.lime}12`,color:C.lime}}>{t}</span>
        ))}
      </div>

      {/* Footer */}
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-end",paddingTop:12,borderTop:`1px solid ${C.border}`}}>
        <div>
          <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:18,color:"#fff",letterSpacing:.5}}>{job.salary_range}</div>
          <div style={{fontSize:10,color:"rgba(255,255,255,.25)",marginTop:2}}>
            üë• {job.filled_seats||0} applied ¬∑ {job.posted_ago||"Recently"}
          </div>
        </div>
        {!isFull && <div className="btn" style={{padding:"8px 16px",borderRadius:10,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,fontWeight:900,fontSize:12}}>APPLY ‚Üí</div>}
      </div>

      {/* Seat bar */}
      <div style={{marginTop:10}}>
        <div style={{display:"flex",justifyContent:"space-between",fontSize:9,marginBottom:3}}>
          <span style={{color:urgent?C.coral:C.lime,fontWeight:700}}>{job.filled_seats||0}/{job.total_seats||10} seats {urgent&&"üî• Filling fast!"}</span>
          <span style={{color:"rgba(255,255,255,.2)"}}>{pct}%</span>
        </div>
        <div style={{height:4,borderRadius:99,background:"rgba(255,255,255,.05)"}}>
          <div style={{width:`${pct}%`,height:"100%",borderRadius:99,background:urgent?`linear-gradient(90deg,${C.coral},#FF6B6B)`:`linear-gradient(90deg,${C.lime},#77DD00)`,transition:"width .6s ease"}}/>
        </div>
      </div>
    </div>
  );
};

/* ‚îÄ‚îÄ Job Detail Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const JobDetail = ({job, onClose, user, onAuthRequired}) => {
  const [applied, setApplied] = useState(false);
  const [loading, setLoading] = useState(false);
  const [applicantName, setApplicantName] = useState(user?.user_metadata?.full_name||"");
  const [applicantEmail, setApplicantEmail] = useState(user?.email||"");
  const [coverNote, setCoverNote] = useState("");
  const [resumeFile, setResumeFile] = useState(null);

  const handleApply = async () => {
    if (!user) return onAuthRequired();
    if (!applicantName || !applicantEmail) return;
    setLoading(true);
    try {
      // 1. Save application to DB
      const { error } = await supabase.from("applications").insert({
        job_id: job.id,
        user_id: user.id,
        applicant_name: applicantName,
        applicant_email: applicantEmail,
        cover_note: coverNote,
        status: "submitted",
      });
      if (error) throw error;

      // 2. Update filled seats (real-time trigger)
      await supabase.from("jobs").update({ filled_seats: (job.filled_seats||0) + 1 }).eq("id", job.id);

      // 3. Send confirmation email via our API
      await fetch("/api/send-confirmation", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ email: applicantEmail, name: applicantName, jobTitle: job.title, company: job.company_name }),
      });

      setApplied(true);
    } catch (err) {
      console.error(err);
    } finally { setLoading(false); }
  };

  return (
    <div style={{position:"fixed",inset:0,zIndex:300,display:"flex",justifyContent:"flex-end"}}>
      <div onClick={onClose} style={{position:"absolute",inset:0,background:"rgba(0,0,0,.75)",backdropFilter:"blur(8px)"}}/>
      <div style={{position:"relative",width:"100%",maxWidth:540,background:C.surface,height:"100vh",overflowY:"auto",
        boxShadow:"-20px 0 80px rgba(0,0,0,.5)",animation:"slideIn .35s cubic-bezier(.22,1,.36,1)",display:"flex",flexDirection:"column"}}>

        {/* Header */}
        <div style={{background:C.card,padding:"22px 24px 18px",borderBottom:`1px solid ${C.border}`,flexShrink:0}}>
          <div style={{display:"flex",justifyContent:"space-between",marginBottom:14}}>
            <div style={{width:56,height:56,borderRadius:18,background:`linear-gradient(135deg,${job.logo_color_1||C.lime},${job.logo_color_2||C.mint})`,
              display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:900,fontSize:24,fontFamily:"'Bebas Neue',cursive"}}>
              {(job.company_name||"?")[0]}
            </div>
            <div onClick={onClose} style={{width:38,height:38,borderRadius:12,background:C.surface,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:`1px solid ${C.border}`,color:C.muted,fontSize:18}}>‚úï</div>
          </div>
          <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:24,color:"#fff",letterSpacing:.5,marginBottom:6}}>{job.title}</div>
          <div style={{fontSize:13,color:C.muted,marginBottom:12}}>{job.company_name} ¬∑ {job.location}</div>
          <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
            <Chip color={C.lime}>{job.work_type}</Chip>
            <Chip color={C.gold}>{job.region}</Chip>
            <Chip color={C.mint}>{job.experience_level}</Chip>
            {(job.filled_seats||0)>=(job.total_seats||10)
              ? <Chip color={C.coral}>Position Filled</Chip>
              : <Chip color={C.mint}>‚úì Actively Hiring</Chip>
            }
          </div>
        </div>

        {/* Content */}
        <div style={{flex:1,overflowY:"auto",padding:24}}>
          {/* Stats grid */}
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:20}}>
            {[["üí∞","Salary",job.salary_range],["üìä","Experience",job.experience_level],
              ["üë•","Applicants",(job.filled_seats||0).toLocaleString("en-IN")],["üè¢","Work Type",job.work_type]].map(([ic,lb,val])=>(
              <div key={lb} style={{padding:"14px",borderRadius:14,background:C.card,border:`1px solid ${C.border}`}}>
                <div style={{fontSize:10,color:C.muted,marginBottom:4,textTransform:"uppercase",letterSpacing:.5}}>{ic} {lb}</div>
                <div style={{fontWeight:800,color:"#fff",fontSize:14}}>{val}</div>
              </div>
            ))}
          </div>

          {/* Description */}
          <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:18,color:"#fff",letterSpacing:.5,marginBottom:10}}>About The Role</div>
          <div style={{fontSize:13,color:"rgba(255,255,255,.55)",lineHeight:1.9,marginBottom:20}}>{job.description||"Exciting opportunity to join a growing team. Apply now to learn more!"}</div>

          {/* Skills */}
          {(job.skills_tags||[]).length>0 && (
            <>
              <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:18,color:"#fff",letterSpacing:.5,marginBottom:10}}>Skills Required</div>
              <div style={{display:"flex",flexWrap:"wrap",gap:8,marginBottom:20}}>
                {job.skills_tags.map(s=><span key={s} style={{padding:"8px 16px",borderRadius:10,background:`${C.lime}12`,color:C.lime,fontWeight:700,fontSize:13,border:`1px solid ${C.lime}25`}}>{s}</span>)}
              </div>
            </>
          )}

          {/* Application Form */}
          {!applied ? (
            <div style={{background:C.card,borderRadius:20,padding:20,border:`1px solid ${C.border}`}}>
              <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:18,color:"#fff",letterSpacing:.5,marginBottom:16}}>APPLY NOW ‚Äî FREE</div>
              <div style={{display:"flex",flexDirection:"column",gap:12}}>
                <input value={applicantName} onChange={e=>setApplicantName(e.target.value)} placeholder="Your full name *" className="input-z"
                  style={{width:"100%",padding:"12px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.surface,color:"#fff"}}/>
                <input value={applicantEmail} onChange={e=>setApplicantEmail(e.target.value)} placeholder="your@email.com *" type="email" className="input-z"
                  style={{width:"100%",padding:"12px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.surface,color:"#fff"}}/>
                <textarea value={coverNote} onChange={e=>setCoverNote(e.target.value)} placeholder="Why are you a good fit? (optional)"
                  style={{width:"100%",padding:"12px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:13,fontFamily:"'Nunito',sans-serif",background:C.surface,color:"#fff",height:80,resize:"none"}} className="input-z"/>
                <button onClick={handleApply} disabled={loading} className="btn"
                  style={{width:"100%",padding:16,borderRadius:14,background:loading?"rgba(170,255,0,.3)":`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,border:"none",fontFamily:"'Bebas Neue',cursive",fontSize:20,letterSpacing:1,cursor:loading?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10}}>
                  {loading ? <><Spinner size={20} color={C.bg}/> Submitting...</> : "SUBMIT APPLICATION üöÄ"}
                </button>
                <div style={{textAlign:"center",fontSize:11,color:C.muted}}>‚úÖ Your email will be sent to {job.company_name} ¬∑ Confirmation sent to you</div>
              </div>
            </div>
          ) : (
            <div style={{padding:28,borderRadius:20,background:`${C.mint}10`,border:`1px solid ${C.mint}30`,textAlign:"center"}}>
              <div style={{fontSize:48,marginBottom:12}} className="float">üéâ</div>
              <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:24,color:C.mint,letterSpacing:.5}}>APPLICATION SUBMITTED!</div>
              <div style={{fontSize:13,color:C.muted,marginTop:8,lineHeight:1.8}}>Check your email at <strong style={{color:"#fff"}}>{applicantEmail}</strong> for confirmation.<br/>We've notified {job.company_name}. Good luck! üôè</div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

/* ‚îÄ‚îÄ Alert Setup ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
const AlertSetup = ({user, onAuthRequired, onToast}) => {
  const [email, setEmail] = useState(user?.email||"");
  const [keyword, setKeyword] = useState("");
  const [region, setRegion] = useState("India");
  const [workType, setWorkType] = useState("Any");
  const [loading, setLoading] = useState(false);
  const [done, setDone] = useState(false);

  const handleSubmit = async () => {
    if (!email) return;
    if (!user) return onAuthRequired();
    setLoading(true);
    try {
      const { error } = await supabase.from("job_alerts").insert({
        user_id: user.id,
        email,
        keyword,
        region: region==="Any"?null:region,
        work_type: workType==="Any"?null:workType,
        active: true,
      });
      if (error) throw error;

      // Send welcome email via API
      await fetch("/api/setup-alert", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({ email, keyword, region, workType }),
      });

      setDone(true);
      onToast("üîî Job alert activated! Check your email.", "success");
    } catch (err) {
      onToast(err.message, "error");
    } finally { setLoading(false); }
  };

  if (done) return (
    <div style={{maxWidth:500,margin:"0 auto",padding:32,textAlign:"center"}}>
      <div style={{fontSize:64,marginBottom:16}} className="float">üéä</div>
      <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:28,color:C.lime,letterSpacing:.5}}>ALERT ACTIVATED!</div>
      <div style={{fontSize:14,color:C.muted,marginTop:10,lineHeight:1.8}}>We'll email <strong style={{color:"#fff"}}>{email}</strong> instantly when new matching jobs are posted.</div>
    </div>
  );

  return (
    <div style={{maxWidth:600,margin:"0 auto",padding:"28px 20px"}}>
      <div className="fu" style={{fontFamily:"'Bebas Neue',cursive",fontSize:34,color:"#fff",letterSpacing:.5,marginBottom:6}}>JOB ALERTS üîî</div>
      <div className="fu1" style={{fontSize:14,color:C.muted,marginBottom:24}}>Get real email alerts the moment new matching jobs are posted. Free forever.</div>
      <div className="fu2" style={{background:C.card,borderRadius:24,padding:28,border:`1px solid ${C.border}`,display:"flex",flexDirection:"column",gap:14}}>
        <div>
          <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:6,textTransform:"uppercase",letterSpacing:.6}}>Your Email *</label>
          <input value={email} onChange={e=>setEmail(e.target.value)} placeholder="you@email.com" className="input-z"
            style={{width:"100%",padding:"13px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.surface,color:"#fff"}}/>
        </div>
        <div>
          <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:6,textTransform:"uppercase",letterSpacing:.6}}>Job Keyword (optional)</label>
          <input value={keyword} onChange={e=>setKeyword(e.target.value)} placeholder="e.g. React Developer, Data Scientist" className="input-z"
            style={{width:"100%",padding:"13px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.surface,color:"#fff"}}/>
        </div>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>
          {[["Region","region",["Any","India","USA","UK","Canada","Australia","Singapore","Global"],region,setRegion],
            ["Work Type","type",["Any","Remote","WFH","Hybrid","In-Office"],workType,setWorkType]].map(([lb,,opts,val,set])=>(
            <div key={lb}>
              <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:6,textTransform:"uppercase",letterSpacing:.6}}>{lb}</label>
              <select value={val} onChange={e=>set(e.target.value)} className="input-z"
                style={{width:"100%",padding:"12px 14px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:13,fontFamily:"'Nunito',sans-serif",background:C.surface,color:"#fff",cursor:"pointer"}}>
                {opts.map(o=><option key={o}>{o}</option>)}
              </select>
            </div>
          ))}
        </div>
        <button onClick={handleSubmit} disabled={loading} className="btn glow-pulse"
          style={{width:"100%",padding:16,borderRadius:14,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,border:"none",fontFamily:"'Bebas Neue',cursive",fontSize:20,letterSpacing:1,cursor:loading?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10}}>
          {loading ? <><Spinner size={20} color={C.bg}/> Setting Up...</> : "üîî ACTIVATE FREE ALERT"}
        </button>
        <div style={{textAlign:"center",fontSize:11,color:C.muted}}>No spam ¬∑ Unsubscribe anytime ¬∑ Real emails via Resend</div>
      </div>
    </div>
  );
};

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MAIN APP
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
export default function App() {
  const [nav, setNav] = useState("jobs");
  const [user, setUser] = useState(null);
  const [jobs, setJobs] = useState([]);
  const [loading, setLoading] = useState(true);
  const [selectedJob, setSelectedJob] = useState(null);
  const [saved, setSaved] = useState(new Set());
  const [search, setSearch] = useState("");
  const [region, setRegion] = useState("All");
  const [workType, setWorkType] = useState("All");
  const [category, setCategory] = useState("All");
  const [expLevel, setExpLevel] = useState("All");
  const [showAuth, setShowAuth] = useState(false);
  const [toast, setToast] = useState(null);
  const [liveCount, setLiveCount] = useState(0);
  const [sortBy, setSortBy] = useState("hot");
  const [showPost, setShowPost] = useState(false);
  const [postForm, setPostForm] = useState({title:"",company_name:"",salary_range:"",location:"",work_type:"Remote",region:"India",category:"Tech",experience_level:"Any",description:"",contact_email:""});
  const [postLoading, setPostLoading] = useState(false);
  const [postDone, setPostDone] = useState(false);

  const showToast = (msg, type="success") => {
    setToast({msg, type});
    setTimeout(()=>setToast(null), 4000);
  };

  // ‚îÄ‚îÄ Auth listener ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  useEffect(()=>{
    supabase.auth.getSession().then(({data:{session}})=>{
      setUser(session?.user||null);
      if(session?.user) loadSavedJobs(session.user.id);
    });
    const {data:{subscription}} = supabase.auth.onAuthStateChange((_event,session)=>{
      setUser(session?.user||null);
      if(session?.user) loadSavedJobs(session.user.id);
    });
    return ()=>subscription.unsubscribe();
  },[]);

  // ‚îÄ‚îÄ Load saved jobs ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const loadSavedJobs = async (userId) => {
    const {data} = await supabase.from("saved_jobs").select("job_id").eq("user_id",userId);
    if(data) setSaved(new Set(data.map(r=>r.job_id)));
  };

  // ‚îÄ‚îÄ Fetch jobs (real data from Adzuna via our API) ‚îÄ
  const fetchJobs = useCallback(async () => {
    setLoading(true);
    try {
      // Fetch ALL jobs in batches of 1000 (Supabase limit per request)
      let allData = [];
      let from = 0;
      const batchSize = 1000;

      while(true) {
        let query = supabase.from("jobs").select("*")
          .eq("is_active",true)
          .order("created_at",{ascending:false})
          .range(from, from + batchSize - 1);

        if(region!=="All") query = query.eq("region",region);
        if(workType!=="All") query = query.eq("work_type",workType);
        if(category!=="All") query = query.eq("category",category);
        if(expLevel!=="All") query = query.eq("experience_level",expLevel);
        if(search) query = query.or(`title.ilike.%${search}%,company_name.ilike.%${search}%`);

        const {data:batch, error} = await query;
        if(error) throw error;
        if(!batch || batch.length === 0) break;
        allData = [...allData, ...batch];
        if(batch.length < batchSize) break;
        from += batchSize;
      }

      if(allData.length > 0) {
        setJobs(allData);
        setLiveCount(allData.length);
      } else {
        // Fallback to Adzuna API
        const res = await fetch(`/api/fetch-jobs?q=${encodeURIComponent(search||"software developer")}&country=in&results_per_page=20`);
        const apiData = await res.json();
        setJobs(apiData.jobs||[]);
        setLiveCount(apiData.total||0);
      }
    } catch (err) {
      console.error("Job fetch error:",err);
      showToast("Couldn't load jobs. Retrying...","error");
    } finally { setLoading(false); }
  },[search,region,workType,category,expLevel]);

  useEffect(()=>{ fetchJobs(); },[fetchJobs]);

  // ‚îÄ‚îÄ Real-time subscription (WebSocket) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  useEffect(()=>{
    const channel = supabase
      .channel("jobs-live")
      .on("postgres_changes",{event:"INSERT",schema:"public",table:"jobs"},(payload)=>{
        setJobs(prev=>[payload.new,...prev]);
        setLiveCount(p=>p+1);
        showToast(`üÜï New job: ${payload.new.title} at ${payload.new.company_name}!`,"success");
      })
      .on("postgres_changes",{event:"UPDATE",schema:"public",table:"jobs"},(payload)=>{
        setJobs(prev=>prev.map(j=>j.id===payload.new.id?payload.new:j));
        // If job just got filled, show toast
        if(payload.new.filled_seats>=payload.new.total_seats && payload.old.filled_seats<payload.old.total_seats) {
          showToast(`‚úÖ Position filled: ${payload.new.title}. Auto-removed from active listings.`,"error");
        }
      })
      .on("postgres_changes",{event:"DELETE",schema:"public",table:"jobs"},(payload)=>{
        setJobs(prev=>prev.filter(j=>j.id!==payload.old.id));
        setLiveCount(p=>Math.max(0,p-1));
      })
      .subscribe();

    return ()=>supabase.removeChannel(channel);
  },[]);

  // ‚îÄ‚îÄ Toggle save job ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const toggleSave = async (jobId) => {
    if(!user) return setShowAuth(true);
    const isSaved = saved.has(jobId);
    if(isSaved) {
      await supabase.from("saved_jobs").delete().eq("user_id",user.id).eq("job_id",jobId);
      setSaved(prev=>{const n=new Set(prev);n.delete(jobId);return n;});
      showToast("Job removed from saved","error");
    } else {
      await supabase.from("saved_jobs").insert({user_id:user.id,job_id:jobId});
      setSaved(prev=>new Set([...prev,jobId]));
      showToast("üíæ Job saved!","success");
    }
  };

  // ‚îÄ‚îÄ Post a job ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const handlePostJob = async () => {
    if(!user) return setShowAuth(true);
    if(!postForm.title||!postForm.company_name||!postForm.salary_range) return showToast("Fill required fields","error");
    setPostLoading(true);
    try {
      const {error} = await supabase.from("jobs").insert({
        ...postForm,
        posted_by: user.id,
        is_active: true,
        is_hot: false,
        is_new: true,
        filled_seats: 0,
        total_seats: 10,
        skills_tags: [],
        logo_color_1: "#AAFF00",
        logo_color_2: "#77DD00",
      });
      if(error) throw error;

      // Trigger alerts for matching users
      await fetch("/api/trigger-alerts",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({title:postForm.title,company:postForm.company_name,region:postForm.region,workType:postForm.work_type}),
      });

      setPostDone(true);
      showToast("üéâ Job posted! Alerts sent to matching users.","success");
    } catch(err) {
      showToast(err.message,"error");
    } finally { setPostLoading(false); }
  };

  // ‚îÄ‚îÄ Sign out ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const handleSignOut = async () => {
    await supabase.auth.signOut();
    setUser(null);
    setSaved(new Set());
    showToast("Signed out successfully","success");
  };

  // ‚îÄ‚îÄ Filter jobs ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const liveJobs  = jobs.filter(j=>!j.filled_seats||(j.filled_seats<(j.total_seats||10)));
  const filledJobs = jobs.filter(j=>j.filled_seats>=(j.total_seats||10));
  const savedJobs  = jobs.filter(j=>saved.has(j.id));

  const NAV = [
    {id:"jobs",icon:"üíº",label:"Jobs"},
    {id:"alerts",icon:"üîî",label:"Alerts"},
    {id:"saved",icon:"üîñ",label:`Saved (${saved.size})`},
  ];

  return (
    <>
      <Styles/>
      <div style={{minHeight:"100vh",background:C.bg,color:"#F0F0FF",fontFamily:"'Nunito',sans-serif"}}>

        {/* NAVBAR */}
        <nav style={{background:C.surface,borderBottom:`1px solid ${C.border}`,position:"sticky",top:0,zIndex:100,boxShadow:"0 4px 30px rgba(0,0,0,.3)"}}>
          <div style={{maxWidth:1400,margin:"0 auto",padding:"0 20px",display:"flex",alignItems:"center",height:64,gap:20}}>
            <div style={{display:"flex",alignItems:"center",gap:10,cursor:"pointer",flexShrink:0}} onClick={()=>setNav("jobs")}>
              <div style={{width:38,height:38,borderRadius:12,background:`linear-gradient(135deg,${C.lime},#77DD00)`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,boxShadow:`0 4px 16px ${C.lime}30`}}>üöÄ</div>
              <div>
                <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:20,color:"#fff",letterSpacing:1,lineHeight:1}}>UDYAM PATH</div>
                <div style={{fontSize:8,color:C.lime,letterSpacing:1.5,textTransform:"uppercase",fontWeight:700}}>Real-Time ¬∑ ‡§â‡§¶‡•ç‡§Ø‡§Æ ‡§™‡§•</div>
              </div>
            </div>

            {/* Live indicator */}
            <div style={{display:"flex",alignItems:"center",gap:6,padding:"5px 12px",borderRadius:999,background:`${C.lime}12`,border:`1px solid ${C.lime}25`,flexShrink:0}}>
              <div style={{width:6,height:6,borderRadius:"50%",background:C.lime,animation:"pulse 1.5s infinite"}}/>
              <span style={{fontSize:11,fontWeight:800,color:C.lime,fontFamily:"'JetBrains Mono',monospace"}}>{liveCount.toLocaleString("en-IN")} LIVE</span>
            </div>

            {/* Nav */}
            <div style={{display:"flex",gap:4,flex:1,justifyContent:"center"}}>
              {NAV.map(item=>(
                <div key={item.id} onClick={()=>setNav(item.id)} className={`btn ${nav===item.id?"nav-active":""}`}
                  style={{padding:"8px 16px",borderRadius:10,fontSize:13,fontWeight:800,color:nav===item.id?C.lime:"rgba(255,255,255,.4)",background:nav===item.id?`${C.lime}10`:"transparent",display:"flex",alignItems:"center",gap:6,transition:"all .2s"}}>
                  <span>{item.icon}</span><span>{item.label}</span>
                </div>
              ))}
            </div>

            {/* Auth + Post */}
            <div style={{display:"flex",gap:10,alignItems:"center",flexShrink:0}}>
              {user ? (
                <div style={{display:"flex",gap:10,alignItems:"center"}}>
                  <div style={{width:34,height:34,borderRadius:10,background:`linear-gradient(135deg,${C.lime},#77DD00)`,display:"flex",alignItems:"center",justifyContent:"center",color:C.bg,fontWeight:900,fontSize:14}}>
                    {(user.user_metadata?.full_name||user.email||"U")[0].toUpperCase()}
                  </div>
                  <div onClick={handleSignOut} className="btn" style={{padding:"8px 14px",borderRadius:10,background:C.card,border:`1px solid ${C.border}`,fontSize:11,fontWeight:700,color:C.muted}}>Sign Out</div>
                </div>
              ) : (
                <div onClick={()=>setShowAuth(true)} className="btn" style={{padding:"10px 20px",borderRadius:12,background:C.card,border:`1px solid ${C.border}`,fontSize:13,fontWeight:800,color:"rgba(255,255,255,.6)"}}>Sign In</div>
              )}
              <button onClick={()=>setShowPost(true)} className="btn glow-pulse"
                style={{padding:"10px 18px",borderRadius:12,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,border:"none",fontWeight:900,fontSize:12,cursor:"pointer",letterSpacing:.5}}>
                + POST JOB FREE
              </button>
            </div>
          </div>
        </nav>

        {/* TICKER */}
        <div style={{background:`${C.lime}10`,borderBottom:`1px solid ${C.lime}12`,padding:"8px 0",overflow:"hidden"}}>
          <div className="marquee-inner">
            {[...Array(2)].map((_,rep)=>(
              ["üî¥ LIVE: Jobs auto-removed when filled","‚ö° Real-time WebSocket updates","üìß Real email alerts via Resend","üåç India + International jobs via Adzuna API","üîî Set alert ‚Äî get emailed instantly on new jobs","‚úÖ Applications saved to Supabase database"].map((t,i)=>(
                <span key={`${rep}-${i}`} style={{marginRight:60,fontSize:11,fontWeight:700,color:i%2===0?C.lime:C.gold,whiteSpace:"nowrap"}}>{t}</span>
              ))
            ))}
          </div>
        </div>

        {/* PAGES */}
        {nav==="jobs"&&(
          <>
            {/* Hero */}
            <div style={{background:`linear-gradient(135deg,${C.bg},#0D1520,${C.bg})`,padding:"60px 20px 48px",position:"relative",overflow:"hidden"}} className="grid-pattern">
              <div style={{position:"absolute",top:-100,right:-100,width:400,height:400,borderRadius:"50%",background:`radial-gradient(circle,${C.lime}08,transparent)`,filter:"blur(60px)"}}/>
              <div style={{maxWidth:860,margin:"0 auto",textAlign:"center",position:"relative"}}>
                <div className="fu" style={{display:"inline-flex",alignItems:"center",gap:8,padding:"6px 16px",borderRadius:999,background:`${C.lime}12`,border:`1px solid ${C.lime}25`,marginBottom:20}}>
                  <div style={{width:8,height:8,borderRadius:"50%",background:C.lime,animation:"pulse 1s infinite"}}/>
                  <span style={{fontSize:11,fontWeight:900,color:C.lime,letterSpacing:1}}>REAL-TIME ¬∑ JOBS UPDATE LIVE ¬∑ AUTO-REMOVED WHEN FILLED</span>
                </div>
                <h1 className="fu1" style={{fontFamily:"'Bebas Neue',cursive",fontSize:"clamp(40px,8vw,76px)",color:"#fff",lineHeight:1,letterSpacing:2,marginBottom:16}}>
                  YOUR DREAM JOB<br/><span style={{color:C.lime}}>STARTS RIGHT NOW</span>
                </h1>
                <p className="fu2" style={{fontSize:15,color:"rgba(255,255,255,.45)",margin:"0 auto 36px",maxWidth:580,lineHeight:1.9}}>
                  Real jobs from Adzuna API ¬∑ Real applications saved to database<br/>Real email alerts when jobs match ¬∑ Real-time WebSocket updates
                </p>
                <div className="fu3" style={{display:"flex",gap:0,background:C.card,borderRadius:20,padding:5,boxShadow:`0 20px 80px rgba(0,0,0,.4)`,maxWidth:640,margin:"0 auto 20px",border:`1px solid ${C.border}`}}>
                  <div style={{flex:1,display:"flex",alignItems:"center",gap:12,padding:"8px 16px"}}>
                    <span style={{fontSize:18}}>üîç</span>
                    <input value={search} onChange={e=>setSearch(e.target.value)} onKeyDown={e=>e.key==="Enter"&&fetchJobs()}
                      placeholder="Search jobs, companies, skills..."
                      className="input-z"
                      style={{border:"none",background:"transparent",fontSize:15,fontFamily:"'Nunito',sans-serif",color:"#fff",width:"100%",outline:"none"}}/>
                  </div>
                  <button onClick={fetchJobs} className="btn" style={{padding:"14px 28px",borderRadius:16,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,border:"none",fontWeight:900,fontSize:15,fontFamily:"'Nunito',sans-serif",cursor:"pointer"}}>SEARCH</button>
                </div>
                <div className="fu3" style={{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"}}>
                  {["üî• Fresher","üåç Remote","üè† WFH","üí∞ High Salary","ü§ñ AI / ML","üöÄ Startup"].map(tag=>(
                    <div key={tag} onClick={()=>{setSearch(tag.split(" ").slice(1).join(" "));fetchJobs();}} className="btn"
                      style={{padding:"7px 16px",borderRadius:999,background:"rgba(255,255,255,.05)",border:`1px solid rgba(255,255,255,.1)`,color:"rgba(255,255,255,.5)",fontSize:12,fontWeight:700}}>
                      {tag}
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* Stats */}
            <div style={{background:C.surface,borderBottom:`1px solid ${C.border}`,padding:"14px 20px"}}>
              <div style={{maxWidth:1400,margin:"0 auto",display:"flex",gap:32,justifyContent:"center",flexWrap:"wrap"}}>
                {[["üíº",liveJobs.length,"Live Jobs",C.lime],["üì´",filledJobs.length,"Filled Today",C.coral],["üîñ",saved.size,"Saved",C.gold],["‚ö°","Live","WebSocket",C.sky]].map(([ic,val,lb,c])=>(
                  <div key={lb} style={{textAlign:"center"}}>
                    <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:22,color:c,letterSpacing:.5}}>{ic} {val}</div>
                    <div style={{fontSize:10,color:"rgba(255,255,255,.25)",textTransform:"uppercase",letterSpacing:.6}}>{lb}</div>
                  </div>
                ))}
              </div>
            </div>

            <div style={{maxWidth:1400,margin:"0 auto",padding:"24px 20px"}}>
              {/* Filters */}
              <div style={{background:C.card,borderRadius:20,padding:18,border:`1px solid ${C.border}`,marginBottom:24}}>
                <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14,flexWrap:"wrap",gap:8}}>
                  <div style={{fontWeight:800,fontSize:14,color:"rgba(255,255,255,.6)"}}>üéõÔ∏è Filter</div>
                  <div style={{display:"flex",gap:10,alignItems:"center"}}>
                    {[region,workType,category,expLevel].some(f=>f!=="All")&&
                      <span onClick={()=>{setRegion("All");setWorkType("All");setCategory("All");setExpLevel("All");}} style={{fontSize:12,color:C.coral,fontWeight:800,cursor:"pointer"}}>Clear √ó</span>}
                    <select value={sortBy} onChange={e=>setSortBy(e.target.value)} style={{padding:"7px 12px",borderRadius:10,border:`1px solid ${C.border}`,fontSize:12,fontWeight:700,color:"#fff",fontFamily:"'Nunito',sans-serif",background:C.surface,cursor:"pointer"}}>
                      <option value="hot">üî• Hot</option><option value="new">üÜï Newest</option><option value="seats">üìä Seats</option>
                    </select>
                  </div>
                </div>
                <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(150px,1fr))",gap:10}}>
                  {[{lb:"Region",opts:["All","India","USA","UK","Canada","Australia","Singapore","Remote ‚Äì Global"],val:region,set:setRegion},
                    {lb:"Work Type",opts:["All","Remote","WFH","Hybrid","In-Office","Freelance"],val:workType,set:setWorkType},
                    {lb:"Category",opts:["All","Tech","Data","Product","Design","Marketing","Sales","HR","Content","Operations"],val:category,set:setCategory},
                    {lb:"Experience",opts:["All","Fresher","0‚Äì2 yrs","2‚Äì5 yrs","5‚Äì10 yrs","10+ yrs"],val:expLevel,set:setExpLevel}].map(f=>(
                    <div key={f.lb}>
                      <div style={{fontSize:10,fontWeight:800,color:"rgba(255,255,255,.25)",marginBottom:5,textTransform:"uppercase",letterSpacing:.6}}>{f.lb}</div>
                      <select value={f.val} onChange={e=>f.set(e.target.value)} className="input-z"
                        style={{width:"100%",padding:"9px 12px",borderRadius:11,border:`1.5px solid ${f.val!=="All"?C.lime:C.border}`,fontSize:12,fontWeight:700,fontFamily:"'Nunito',sans-serif",background:f.val!=="All"?`${C.lime}08`:C.surface,color:f.val!=="All"?C.lime:"rgba(255,255,255,.5)",cursor:"pointer",transition:"all .2s"}}>
                        {f.opts.map(o=><option key={o}>{o}</option>)}
                      </select>
                    </div>
                  ))}
                </div>
              </div>

              {/* Job Grid */}
              <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:24,color:"#fff",letterSpacing:.5,marginBottom:16}}>
                {loading?"LOADING LIVE JOBS...":`${liveJobs.length} LIVE JOBS`}
                <span style={{fontSize:11,fontFamily:"'Nunito',sans-serif",fontWeight:600,letterSpacing:0,color:"rgba(255,255,255,.25)",marginLeft:12}}>
                  {loading?"Fetching from Adzuna API + Database...":"From Adzuna API + Database ¬∑ Auto-updates via WebSocket"}
                </span>
              </div>

              {loading ? (
                <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:14}}>
                  {[...Array(8)].map((_,i)=><SkeletonCard key={i}/>)}
                </div>
              ) : liveJobs.length > 0 ? (
                <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:14,marginBottom:24}}>
                  {liveJobs.map((job,i)=>(
                    <div key={job.id} className="fu" style={{animationDelay:`${Math.min(i*.04,.4)}s`}}>
                      <JobCard job={job} onOpen={setSelectedJob} saved={saved.has(job.id)} onSave={toggleSave} user={user} onAuthRequired={()=>setShowAuth(true)}/>
                    </div>
                  ))}
                </div>
              ) : (
                <div style={{padding:"60px 20px",textAlign:"center",background:C.card,borderRadius:20,border:`1px solid ${C.border}`,marginBottom:24}}>
                  <div style={{fontSize:48,marginBottom:12}}>üîç</div>
                  <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:22,color:"#fff",marginBottom:12}}>No Jobs Found</div>
                  <div onClick={()=>{setSearch("");setRegion("All");setWorkType("All");setCategory("All");setExpLevel("All");fetchJobs();}} className="btn" style={{display:"inline-block",padding:"12px 28px",borderRadius:14,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,fontWeight:900,fontSize:14,cursor:"pointer"}}>Clear Filters & Reload</div>
                </div>
              )}

              {/* Filled Jobs */}
              {filledJobs.length>0&&(
                <>
                  <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:18,color:"rgba(255,77,109,.5)",letterSpacing:.5,marginBottom:12}}>
                    POSITIONS FILLED ({filledJobs.length}) ‚Äî Auto-removed from active listings
                  </div>
                  <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:14,marginBottom:24}}>
                    {filledJobs.map(job=><JobCard key={job.id} job={job} onOpen={()=>{}} saved={saved.has(job.id)} onSave={toggleSave} user={user} onAuthRequired={()=>setShowAuth(true)}/>)}
                  </div>
                </>
              )}

              {/* Alert CTA */}
              <div style={{background:`linear-gradient(135deg,rgba(170,255,0,.06),rgba(56,189,248,.04))`,border:`1px solid ${C.lime}20`,borderRadius:24,padding:"28px 32px",display:"flex",gap:24,alignItems:"center",flexWrap:"wrap"}}>
                <div style={{fontSize:44}} className="float">üîî</div>
                <div style={{flex:1,minWidth:220}}>
                  <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:22,color:"#fff",letterSpacing:.5}}>REAL EMAIL ALERTS ‚Äî FREE</div>
                  <div style={{fontSize:13,color:C.muted,marginTop:4}}>Get emailed the instant a matching job is posted. Powered by Resend.</div>
                </div>
                <div onClick={()=>setNav("alerts")} className="btn glow-pulse" style={{padding:"14px 28px",borderRadius:14,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,fontWeight:900,fontSize:14,cursor:"pointer"}}>Set Alert Free ‚Üí</div>
              </div>
            </div>
          </>
        )}

        {nav==="alerts"&&<AlertSetup user={user} onAuthRequired={()=>setShowAuth(true)} onToast={showToast}/>}

        {nav==="saved"&&(
          <div style={{maxWidth:1100,margin:"0 auto",padding:"28px 20px"}}>
            <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:34,color:"#fff",letterSpacing:.5,marginBottom:6}}>SAVED JOBS üîñ</div>
            <div style={{fontSize:13,color:C.muted,marginBottom:24}}>Saved to your Supabase account ¬∑ Synced across devices</div>
            {!user ? (
              <div style={{padding:"60px 20px",textAlign:"center",background:C.card,borderRadius:20,border:`1px solid ${C.border}`}}>
                <div style={{fontSize:48,marginBottom:12}}>üîê</div>
                <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:22,color:"#fff",marginBottom:12}}>Sign In to Save Jobs</div>
                <div onClick={()=>setShowAuth(true)} className="btn" style={{display:"inline-block",padding:"14px 32px",borderRadius:16,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,fontWeight:900,fontSize:15,cursor:"pointer"}}>Sign In / Create Account ‚Üí</div>
              </div>
            ) : savedJobs.length===0 ? (
              <div style={{padding:"60px 20px",textAlign:"center",background:C.card,borderRadius:20,border:`1px solid ${C.border}`}}>
                <div style={{fontSize:48,marginBottom:12}}>üè∑Ô∏è</div>
                <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:22,color:"#fff",marginBottom:12}}>NO SAVED JOBS</div>
                <div onClick={()=>setNav("jobs")} className="btn" style={{display:"inline-block",padding:"14px 32px",borderRadius:16,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,fontWeight:900,fontSize:15,cursor:"pointer"}}>Browse Jobs ‚Üí</div>
              </div>
            ) : (
              <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(320px,1fr))",gap:14}}>
                {savedJobs.map(job=><JobCard key={job.id} job={job} onOpen={setSelectedJob} saved={true} onSave={toggleSave} user={user} onAuthRequired={()=>setShowAuth(true)}/>)}
              </div>
            )}
          </div>
        )}

        {/* POST JOB MODAL */}
        {showPost&&(
          <div style={{position:"fixed",inset:0,zIndex:300,display:"flex",alignItems:"center",justifyContent:"center",padding:20}}>
            <div onClick={()=>{setShowPost(false);setPostDone(false);}} style={{position:"absolute",inset:0,background:"rgba(0,0,0,.85)",backdropFilter:"blur(8px)"}}/>
            <div style={{position:"relative",background:C.surface,borderRadius:28,maxWidth:560,width:"100%",overflow:"hidden",maxHeight:"90vh",display:"flex",flexDirection:"column",border:`1px solid ${C.border}`}}>
              <div style={{background:C.card,padding:"22px 24px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
                <div>
                  <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:22,color:"#fff",letterSpacing:.5}}>POST A JOB ‚Äî FREE</div>
                  <div style={{fontSize:11,color:C.muted,marginTop:2}}>Saved to database ¬∑ Alerts sent to matching users instantly</div>
                </div>
                <div onClick={()=>{setShowPost(false);setPostDone(false);}} className="btn" style={{width:36,height:36,borderRadius:12,background:C.surface,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:`1px solid ${C.border}`,color:C.muted,fontSize:18}}>‚úï</div>
              </div>
              {!postDone?(
                <div style={{padding:24,overflowY:"auto",flex:1,display:"flex",flexDirection:"column",gap:12}}>
                  {[["Job Title *","title","e.g. Senior React Developer"],["Company Name *","company_name","e.g. Your Company"],["Location","location","e.g. Bengaluru / Remote"],["Salary Range *","salary_range","e.g. ‚Çπ8‚Äì15 LPA"],["Contact Email *","contact_email","hr@company.com"],["Job Description","description","Describe the role..."]].map(([lb,key,ph])=>(
                    <div key={key}>
                      <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:5,textTransform:"uppercase",letterSpacing:.6}}>{lb}</label>
                      {key==="description"?(
                        <textarea value={postForm[key]} onChange={e=>setPostForm(f=>({...f,[key]:e.target.value}))} placeholder={ph} className="input-z"
                          style={{width:"100%",padding:"12px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:13,fontFamily:"'Nunito',sans-serif",background:C.card,color:"#fff",height:80,resize:"none"}}/>
                      ):(
                        <input value={postForm[key]} onChange={e=>setPostForm(f=>({...f,[key]:e.target.value}))} placeholder={ph} className="input-z"
                          style={{width:"100%",padding:"12px 16px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:14,fontFamily:"'Nunito',sans-serif",background:C.card,color:"#fff"}}/>
                      )}
                    </div>
                  ))}
                  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>
                    {[["Work Type","work_type",["Remote","WFH","Hybrid","In-Office"]],["Region","region",["India","USA","UK","Canada","Australia","Singapore","Global"]]].map(([lb,key,opts])=>(
                      <div key={key}>
                        <label style={{fontSize:11,fontWeight:800,color:C.muted,display:"block",marginBottom:5,textTransform:"uppercase",letterSpacing:.6}}>{lb}</label>
                        <select value={postForm[key]} onChange={e=>setPostForm(f=>({...f,[key]:e.target.value}))} className="input-z"
                          style={{width:"100%",padding:"11px 14px",borderRadius:12,border:`1.5px solid ${C.border}`,fontSize:13,fontFamily:"'Nunito',sans-serif",background:C.card,color:"#fff",cursor:"pointer"}}>
                          {opts.map(o=><option key={o}>{o}</option>)}
                        </select>
                      </div>
                    ))}
                  </div>
                </div>
              ):(
                <div style={{padding:40,textAlign:"center"}}>
                  <div style={{fontSize:64,marginBottom:16}} className="float">üéä</div>
                  <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:26,color:C.lime,letterSpacing:.5}}>JOB LIVE!</div>
                  <div style={{fontSize:13,color:C.muted,margin:"12px 0 24px",lineHeight:1.8}}>Job saved to database. Alerts sent to all matching users via email.</div>
                </div>
              )}
              {!postDone&&(
                <div style={{padding:"16px 24px 24px",borderTop:`1px solid ${C.border}`}}>
                  <button onClick={handlePostJob} disabled={postLoading} className="btn glow-pulse"
                    style={{width:"100%",padding:16,borderRadius:14,background:`linear-gradient(135deg,${C.lime},#77DD00)`,color:C.bg,border:"none",fontFamily:"'Bebas Neue',cursive",fontSize:20,letterSpacing:1,cursor:postLoading?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10}}>
                    {postLoading?<><Spinner size={20} color={C.bg}/> Posting...</>:"üöÄ POST JOB FREE"}
                  </button>
                  {!user&&<div style={{textAlign:"center",marginTop:8,fontSize:11,color:C.muted}}>You'll be asked to sign in first</div>}
                </div>
              )}
            </div>
          </div>
        )}

        {/* JOB DETAIL */}
        {selectedJob&&<JobDetail job={selectedJob} onClose={()=>setSelectedJob(null)} user={user} onAuthRequired={()=>setShowAuth(true)}/>}

        {/* AUTH MODAL */}
        {showAuth&&<AuthModal onClose={()=>setShowAuth(false)} onAuth={u=>{setUser(u);showToast(`Welcome, ${u.user_metadata?.full_name||u.email}! üéâ`,"success");}}/>}

        {/* TOAST */}
        {toast&&<Toast msg={toast.msg} type={toast.type} onClose={()=>setToast(null)}/>}

        {/* FOOTER */}
        <footer style={{background:"#05050A",borderTop:`1px solid ${C.border}`,padding:"32px 20px 20px",marginTop:40}}>
          <div style={{maxWidth:1400,margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:16}}>
            <div style={{display:"flex",alignItems:"center",gap:10}}>
              <div style={{width:30,height:30,borderRadius:10,background:`linear-gradient(135deg,${C.lime},#77DD00)`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:16}}>üöÄ</div>
              <div style={{fontFamily:"'Bebas Neue',cursive",fontSize:18,color:"#fff",letterSpacing:1}}>UDYAM PATH</div>
            </div>
            <div style={{fontSize:11,color:"rgba(255,255,255,.2)",textAlign:"center"}}>
              Real-time via Supabase WebSocket ¬∑ Jobs via Adzuna API ¬∑ Emails via Resend ¬∑ Hosted on Vercel
            </div>
            <div style={{display:"flex",gap:8}}>
              <Chip color={C.lime}>Supabase ‚úì</Chip>
              <Chip color={C.sky}>Adzuna API ‚úì</Chip>
              <Chip color={C.gold}>Resend ‚úì</Chip>
            </div>
          </div>
        </footer>
      </div>
    </>
  );
}
